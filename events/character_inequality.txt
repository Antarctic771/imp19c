namespace = character_inequality

character_inequality.1 = { # Adding cultural office-holding restrictions
	# Triggered on the on_action on_character_created, or for every character when the restriction law is activated
	type = character_event
	hidden = yes
	
	trigger = {

	}

	immediate = {
		employer.culture_group = {
			save_scope_as = employer_culture_group
		}
		if = {
			limit = {
				employer = {
					OR = {
						has_law = dominant_culture_primacy
						has_law = limited_cultural_recognition
					}
					#NOT = { THIS.country_culture_group = character_culture_group }
				}
				NOT = { has_same_culture_group_as = employer.current_ruler }
			}
			remove_all_offices = yes
			remove_party_leadership_effect = yes
			add_trait = "discriminated"
		}
		
	}

}

character_inequality.2 = { # Giving back the right to hold office to characters
	# Triggered on the passing of the law
	type = character_event
	hidden = yes
	
	trigger = {

	}

	immediate = {

	}

}

character_inequality.3 = { # Removing potential for jobs from women
	# Triggered on the on_action on_character_created, or for every character when the restriction law is activated
	type = character_event
	hidden = yes
	
	trigger = {
		employer = {
			NOT = {
				has_law = womens_suffrage_law
			}
		}
		is_female = yes
	}

	immediate = {
		if = {
			limit = {
				employer = {
					NOT = {
							has_law = womens_suffrage_law
						}
					}
				is_female = yes
			}
			remove_all_offices = yes
			remove_party_leadership_effect = yes
			add_trait = "discriminated"
		}
		
	}

}

character_inequality.4 = { # Giving back the right to hold office to women
	# Triggered on the passing of the law
	type = character_event
	hidden = yes
	
	trigger = {

	}

	immediate = {

	}

}

character_inequality.5 = { # Run on game init
	type = country_event
	hidden = yes
	
	trigger = {
		exists = yes
	}

	immediate = {
		every_character = {
			limit = {
				exists = yes
			}
			trigger_event = {
				id = character_inequality.1 # Adding cultural office-holding restrictions
			}
			trigger_event = {
				id = character_inequality.3 # Removing potential for jobs from women
			}
			trigger_event = {
				id = character_inequality.6 # Removing ineligible party leaders
			}
		}
	}

}

character_inequality.6 = { # Run on party change of leadership, and on startup
	type = country_event
	hidden = yes
	
	trigger = {
	}

	immediate = {
		while = {
			limit = {
				any_character = {
					is_party_leader = yes
					has_trait = discriminated
				}
			}
			every_character = {
				limit = {
					is_party_leader = yes
					has_trait = discriminated
				}
				remove_party_leadership_effect = yes
			}
		}
	}

}